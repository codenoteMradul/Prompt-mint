<% bundle = local_assigns.fetch(:bundle) %>
<% unlocked = local_assigns.fetch(:unlocked) %>
<% owner = local_assigns.fetch(:owner) %>

<div
  class="group relative h-full overflow-hidden rounded-2xl border border-white/10 bg-white/[0.04] shadow-[0_0_0_1px_rgba(255,255,255,0.03)] backdrop-blur transition-all duration-300 hover:border-white/20 hover:bg-white/[0.06]"
  data-prompt-filter-target="card"
  data-category="<%= bundle.category %>"
>
  <div class="absolute inset-0 -z-10 opacity-0 transition-opacity duration-300 group-hover:opacity-100">
    <div class="absolute -top-24 -right-24 h-48 w-48 rounded-full bg-pink-400/15 blur-3xl"></div>
    <div class="absolute -bottom-24 -left-24 h-48 w-48 rounded-full bg-cyan-400/10 blur-3xl"></div>
  </div>

  <div class="flex h-full flex-col p-5">
    <div class="flex items-start justify-between gap-3">
      <div class="min-w-0">
        <h3 class="truncate text-base font-semibold tracking-tight text-white"><%= bundle.title %></h3>
        <p class="mt-1 text-sm text-slate-300"><%= truncate(bundle.description.to_s, length: 120) %></p>
      </div>

      <div class="flex flex-none flex-col items-end gap-2">
        <span class="rounded-full border border-white/10 bg-white/5 px-2.5 py-1 text-xs text-slate-200"><%= bundle.category.titleize %></span>
        <span class="text-sm font-semibold text-white">$<%= bundle.price %></span>
      </div>
    </div>

    <div class="mt-4 flex items-center justify-between">
      <% if owner %>
        <span class="rounded-full bg-white/5 px-2.5 py-1 text-xs text-slate-300">Owner</span>
      <% elsif unlocked %>
        <span class="rounded-full bg-emerald-500/10 px-2.5 py-1 text-xs text-emerald-200">Unlocked</span>
      <% else %>
        <span class="rounded-full bg-amber-500/10 px-2.5 py-1 text-xs text-amber-200">Locked</span>
      <% end %>

      <span class="text-xs text-slate-400"><%= bundle.prompts.size %> Prompts Included</span>
    </div>

    <div class="mt-4 flex-1 rounded-2xl border border-white/10 bg-black/20 p-4">
      <div class="text-xs font-semibold uppercase tracking-wider text-slate-400">Includes</div>
      <ul class="mt-2 space-y-1 text-sm text-slate-200">
        <% bundle.prompts.first(3).each do |prompt| %>
          <li class="truncate">â€¢ <%= prompt.title %></li>
        <% end %>
      </ul>
      <% if bundle.prompts.size > 3 %>
        <div class="mt-2 text-xs text-slate-400">+ <%= bundle.prompts.size - 3 %> more</div>
      <% end %>
    </div>

    <div class="mt-5 flex items-center justify-between gap-3">
      <%= link_to "View", bundle_path(bundle), class: "text-sm text-slate-300 hover:text-white transition-colors duration-300" %>

      <% unless owner || unlocked %>
        <%= button_to "Buy Bundle", bundle_bundle_purchases_path(bundle), method: :post, form_class: "inline-flex", class: "rounded-2xl bg-gradient-to-r from-fuchsia-500 via-pink-500 to-cyan-400 px-4 py-2.5 text-sm font-semibold text-black shadow-[0_0_30px_rgba(217,70,239,0.25)] hover:shadow-[0_0_40px_rgba(34,211,238,0.25)] transition-all duration-300" %>
      <% end %>
    </div>
  </div>
</div>
