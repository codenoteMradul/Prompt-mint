<div class="mb-8">
  <div class="flex items-start justify-between gap-4">
    <div>
      <h1 class="text-2xl font-semibold tracking-tight text-white">Dashboard</h1>
      <p class="mt-1 text-sm text-slate-400">Discover premium bundles. Unlock complete workflows, fast.</p>
    </div>
  </div>

  <div class="mt-6" data-controller="prompt-filter">
    <%= form_with url: dashboard_path, method: :get, class: "mb-4" do |form| %>
      <%= form.hidden_field :category, value: params[:category], data: { prompt_filter_target: "categoryField" } %>

      <div class="relative">
        <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4 text-slate-400">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-5 w-5">
            <path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.32l4.92 4.91a.75.75 0 1 1-1.06 1.06l-4.91-4.92A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd" />
          </svg>
        </div>

        <%= form.search_field :query,
          value: params[:query],
          placeholder: "Search by creator, bundle title, or category...",
          class: "w-full rounded-2xl border border-white/10 bg-black/30 py-3 pl-12 pr-28 text-sm text-white outline-none transition-all duration-300 placeholder:text-slate-500 focus:border-cyan-400/40 focus:ring-4 focus:ring-cyan-400/10" %>

        <div class="absolute inset-y-0 right-0 flex items-center pr-2">
          <%= form.submit "Search", class: "rounded-2xl bg-white/5 px-4 py-2 text-sm font-semibold text-slate-100 hover:bg-white/10 transition-all duration-300" %>
        </div>
      </div>
    <% end %>

    <div class="flex flex-wrap gap-2">
      <button type="button" class="rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm text-slate-200 hover:bg-white/10 transition-all duration-300" data-action="prompt-filter#showAll" data-prompt-filter-target="pill">
        All
      </button>
      <% Bundle.categories.keys.each do |category| %>
        <button
          type="button"
          class="rounded-full border border-white/10 bg-white/5 px-4 py-2 text-sm text-slate-200 hover:bg-white/10 transition-all duration-300"
          data-action="prompt-filter#filter"
          data-category="<%= category %>"
          data-prompt-filter-target="pill"
        >
          <%= category.titleize %>
        </button>
      <% end %>
    </div>

    <div class="mt-6 flex items-center justify-between">
      <h2 class="text-sm font-semibold tracking-wide text-white">Bundles</h2>
    </div>

    <% if @bundles.any? %>
      <div class="mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3">
        <% @bundles.each do |bundle| %>
          <% owner = bundle.user_id == current_user.id %>
          <% unlocked = owner || @purchased_bundle_ids.include?(bundle.id) %>
          <%= render "shared/bundle_card", bundle:, unlocked:, owner: %>
        <% end %>
      </div>
    <% else %>
      <div class="mt-4 rounded-2xl border border-white/10 bg-white/[0.04] p-10 text-center shadow-[0_0_0_1px_rgba(255,255,255,0.03)] backdrop-blur">
        <div class="mx-auto flex h-12 w-12 items-center justify-center rounded-2xl border border-white/10 bg-black/30 text-slate-200">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6">
            <path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.32l4.92 4.91a.75.75 0 1 1-1.06 1.06l-4.91-4.92A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd" />
          </svg>
        </div>
        <h3 class="mt-4 text-sm font-semibold text-white">No bundles found. Try a different search.</h3>
        <p class="mt-1 text-sm text-slate-400">Search by creator name, bundle title, or category.</p>
      </div>
    <% end %>
  </div>
</div>
